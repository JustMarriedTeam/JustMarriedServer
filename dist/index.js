"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function setUpEnvironment(){var e=(0,_pick2.default)(process.env,"port","envPropsFile","dbUrl","jwtSecret");(0,_nodeEnvFile2.default)(__dirname+"/env.properties");var o=e.envPropsFile;o&&(log("Reading custom config from file "+o+"."),(0,_nodeEnvFile2.default)(o,{overwrite:!0,raise:!1})),(0,_extend2.default)(process.env,e),log("Environment variables: "+JSON.stringify(process.env)),Promise=require("bluebird")}function connectDatabase(){_mongoose2.default.Promise=Promise,Promise.promisifyAll(_mongoose2.default),_mongoose2.default.connect(process.env.dbUrl,{server:{socketOptions:{keepAlive:1}}}),_mongoose2.default.connection.on("error",function(){throw new Error("unable to connect to database: "+process.env.dbUrl)}),process.env.MONGOOSE_DEBUG&&_mongoose2.default.set("err",function(e,o,r,n){err(e+"."+o,_util2.default.inspect(r,!1,20),n)})}function launchServer(){app=require("./app.js"),module.parent||(log("Starting server on "+process.env.port+" port"),app.listen(process.env.port,function(){err("server started on port "+process.env.port+" ("+process.env.env+")")}))}Object.defineProperty(exports,"__esModule",{value:!0});var _mongoose=require("mongoose"),_mongoose2=_interopRequireDefault(_mongoose),_util=require("util"),_util2=_interopRequireDefault(_util),_nodeEnvFile=require("node-env-file"),_nodeEnvFile2=_interopRequireDefault(_nodeEnvFile),_extend=require("lodash/extend"),_extend2=_interopRequireDefault(_extend),_pick=require("lodash/pick"),_pick2=_interopRequireDefault(_pick),err=require("debug")("err:index"),log=require("debug")("log:index");log.log=console.log.bind(console);var app=void 0;log("xyz"),err("dupa"),setUpEnvironment(),connectDatabase(),launchServer(),exports.default=app,module.exports=exports.default;